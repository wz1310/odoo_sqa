<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <record id="sale_order_form_view" model="ir.ui.view">
        <field name="name">sale.order.form.view</field>
        <field name="model">sale.order</field>
        <field name="inherit_id" ref="sale.view_order_form"/>
        <field name="arch" type="xml">
        	<xpath expr="//header/button[@name='action_confirm'][1]" position="attributes">
        		<attribute name="context">{'process_check': True}</attribute>
          </xpath>
          <xpath expr="//header/button[@name='action_confirm'][2]" position="attributes">
            <attribute name="context">{'process_check': True}</attribute>
          </xpath>
          <xpath expr="//header" position="inside">
              <button name="action_confirm" string="Approve" type="object" context="{'process_check2': True}"
                attrs="{'invisible': [('state', 'not in', ['approval1'])]}" groups="sale_credit_limit.group_sale_approval_one"/>
              <button name="action_approve_pass_stock" string="Approve" type="object"
                attrs="{'invisible': [('state', 'not in', ['approval2'])]}" groups="sale_credit_limit.group_sale_approval_two"/>
              <button name="action_confirm" string="Approve" type="object"
                attrs="{'invisible': [('state', 'not in', ['approval3'])]}" groups="sale_credit_limit.group_sale_approval_three"/>
          </xpath>
          <xpath expr="//header/button[@name='action_cancel']" position="attributes">
              <attribute name="states">draft,sent,sale,approval1,approval2,approval3</attribute>
          </xpath>
          <xpath expr="//tree/field[@name='product_uom_qty']" position="after">
              <field name="qty_stock" invisible="1"/>
              <field name="product_type" />
          </xpath>
          <xpath expr="//field[@name='order_line']/form/group/group/field[@name='product_id']" position="after">
              <field name="qty_stock" invisible="1"/>
          </xpath>
          <xpath expr="//field[@name='order_line']/kanban" position="inside">
              <field name="qty_stock" invisible="1"/>
          </xpath>
          <xpath expr="//field[@name='order_line']/kanban/templates/t/div/t/div[3]" position="after">
              <div class="row">
                  <div class="col-12 text-muted">
                      <span>
                          Quantity Stock:
                          <t t-esc="record.qty_stock.value"/>
                      </span>
                  </div>
              </div>
          </xpath>
          <xpath expr="//field[@name='validity_date']" position="before">
              <field name="status_so" groups="base.group_system" />
          </xpath>
          <xpath expr="//tree[1]" position="attributes">
              <attribute name="decoration-danger">product_type == 'product' and qty_stock&lt;product_uom_qty</attribute>
          </xpath>
        </field>
    </record>
        
    <record id="view_sale_order_kanban" model="ir.ui.view">
        <field name="name">sale.order.kanban</field>
        <field name="model">sale.order</field>
        <field name="inherit_id" ref="sale.view_sale_order_kanban" />
        <field name="arch" type="xml">
        	<xpath expr="//kanban" position="inside">
        		<field name="user_id"/>
        		<field name="status_so"/>
        		<field name="street"/>
        	</xpath>
            <xpath expr="//kanban/templates/t/div/div[1]" position="after">
                <div class="o_kanban_record_bottom">
                   <div class="oe_kanban_bottom_left text-muted">
                       <span><t t-esc="record.street.value"/></span>
                   </div>
               </div>
               <div class="o_kanban_record_bottom">
                   <div class="oe_kanban_bottom_left text-muted">
                       <span><t t-esc="record.user_id.value"/></span>
                   </div>
                   <div class="oe_kanban_bottom_right">
                      <span><t t-esc="record.status_so.value"/></span>
                   </div>
               </div>
            </xpath>
        </field>
    </record>
</odoo>