<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <record id="view_partner_form" model="ir.ui.view">
        <field name="name">res.partner.form.view</field>
        <field name="model">res.partner</field>
        <field name="inherit_id" ref="base.view_partner_form"/>
        <field name="arch" type="xml">
        	<xpath expr="//sheet" position="before">
                <header>
                    <button name="btn_approve" type="object" string="Approve"  class="btn-primary" attrs="{'invisible':['|',('user_can_approve','=',False), ('state','not in',['waiting_approval'])]}" />
                    <button name="open_reject_message_wizard" type="object" string="Reject" attrs="{'invisible':['|',('user_can_approve','=',False), ('state','not in',['waiting_approval'])]}"/>
                    <button name="btn_submit" states="draft" type="object" string="Submit" class="btn-primary"/>
                    <button name="btn_draft" type="object" string="Set to Draft" attrs="{'invisible':[('user_can_approve','=',False)]}"/>
                    <field name="state" widget="statusbar" statusbar_visible="draft,waiting_approval,approved" />
                </header>
            </xpath>
            <xpath expr="//div[@name='button_box']" position="attributes">
                <attribute name="attrs">{'invisible': [('state', 'in', ['draft','waiting_approval'])]}</attribute>
            </xpath>
            <xpath expr="//div[@name='button_box']" position="after">
                <widget name="web_ribbon" text="New" bg_color="bg-danger" attrs="{'invisible':['|', ('customer','!=',True),('state','not in',['draft','waiting_approval'])]}" />
            </xpath>
            
            <xpath expr="//field[@name='active']" position="attributes">
                <attribute name="attrs">{'invisible': [('state', 'in', ['draft','waiting_approval'])]}</attribute>
            </xpath>
            <field name="company_type" position="attributes">
                <attribute name="invisible">1</attribute>
            </field>
            <xpath expr="//notebook" position="inside">
                <page string="Documents">
                    <group>
                        <field name="owner_file_name" groups="base.group_no_one" />
                        <field name="owner_image" filename="owner_file_name"/>
                        <field name="warehouse_file_name" groups="base.group_no_one" />
                        <field name="warehouse_image" filename="warehouse_file_name"/>
                    </group>
                    <field name="document_ids">
                        <tree editable="bottom">
                            <field name="field_id"/>
                            <field name="file"/>
                        </tree>
                    </field>
                </page>
                <page id="page_approval" string="Approvals">
                    <field name="approvers_ids" invisible="1"/>
                    <field name="user_can_approve" invisible="1" />
                    <field name="approval_ids" readonly="1"/>
                    <group><field name="approved"/></group>
                    <button string="Fetch Matrix" type="object" context="{'force_company':False}" name="checking_approval_matrix" class="oe_highlight" groups="base.group_system" />
                </page>
            </xpath>
            <field name="name" position="after">
                <h2><field name="code"/></h2>
            </field>
            <xpath expr="//field[@name='vat'][1]" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>
            
            <xpath expr="//group[@name='sale']" position="inside">
                <field name="customer"/>
                <field name="join_date"/>
                <field name="first_sales_transaction_date"/>
                <field name="property_product_pricelist"/>
            </xpath>
            <xpath expr="//group[@name='sale']/field[@name='user_id']" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>
            <xpath expr="//group[@name='purchase']" position="inside">
                <field name="supplier"/>
            </xpath>
            <xpath expr="//group[@name='misc']" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>
            <xpath expr="//field[@name='function']" position="after">
                <field name="company_id" options="{'no_create': True}"/>
            </xpath>
            <xpath expr="//field[@name='company_id']" position="after">
                <field name="operating_unit_id" options="{'no_create': True}" domain="[('related_company_id','=',company_id)]"/>
            </xpath>
        </field>
    </record>
    
    <!-- Account -->
    <record id="view_partner_property_form_inherit" model="ir.ui.view">
        <field name="name">view.partner.property.form.inherit</field>
        <field name="model">res.partner</field>
        <field name="inherit_id" ref="account.view_partner_property_form"/>
        <field name="arch" type="xml">
        	<xpath expr="//group[@name='fiscal_information']" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>
            <!-- <xpath expr="//page[@name='accounting']" position="attributes">
                <attribute name="attrs">{'invisible': [('state', '!=', 'approved')]}</attribute>
            </xpath> -->
        </field>
    </record>

    <record model="ir.ui.view" id="partner_view_short_extra_inherit">
        <field name="name">view.partner.property.form.inherit</field>
        <field name="model">res.partner</field>
        <field name="inherit_id" ref="account.partner_view_short_extra" />
        <field name="arch" type="xml">
            <field name='property_account_position_id' position="attributes">
                <attribute name="invisible">1</attribute>
            </field>
        </field>
    </record>

    <!-- Stock -->
    <record id="view_partner_stock_form_inherit" model="ir.ui.view">
        <field name="name">view.partner.stock.form.inherit</field>
        <field name="model">res.partner</field>
        <field name="inherit_id" ref="stock.view_partner_stock_form"/>
        <field name="arch" type="xml">
        	<xpath expr="//group[@name='inventory']" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>
        </field>
    </record>

    <!-- partner_credit_limit -->
    <record id="view_partner_stock_form_inherit" model="ir.ui.view">
        <field name="name">view.partner.stock.form.inherit</field>
        <field name="model">res.partner</field>
        <field name="inherit_id" ref="stock.view_partner_stock_form"/>
        <field name="arch" type="xml">
        	<xpath expr="//group[@name='inventory']" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>
        </field>
    </record>

    <!-- delivery -->
    <record id="view_partner_property_form_inherit1" model="ir.ui.view">
        <field name="name">res.partner.delivery.property.form.inherit</field>
        <field name="model">res.partner</field>
        <field name="inherit_id" ref="delivery.view_partner_property_form" />
        <field name="arch" type="xml">
            <xpath expr="//group[@name='sale']/field[@name='property_delivery_carrier_id']" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>
        </field>
    </record>

    <!-- Sale -->
    <record id="res_partner_view_form_property_inherit2" model="ir.ui.view">
        <field name="name">res.partner.view.form.property.inherit2</field>
        <field name="model">res.partner</field>
        <field name="inherit_id" ref="sale.res_partner_view_form_property_inherit"/>
        <field name="arch" type="xml">
            <field name="property_payment_term_id" position="attributes">
                <attribute name="invisible">1</attribute>
            </field>
            <field name="property_supplier_payment_term_id" position="attributes">
                <attribute name="invisible">1</attribute>
            </field>
        </field>
    </record>

    <!-- Product -->
    <record id="view_partner_property_form_inherit2" model="ir.ui.view">
        <field name="name">res.partner.product.property.form.inherit2</field>
        <field name="model">res.partner</field>
        <field name="inherit_id" ref="product.view_partner_property_form"/>
        <field name="arch" type="xml">
            <field name="property_product_pricelist" position="attributes">
                <attribute name="invisible">1</attribute>
            </field>
        </field>
    </record>
     
    <record id="view_partner_search" model="ir.ui.view">
        <field name="name">res.partner.search.view</field>
        <field name="model">res.partner</field>
        <field name="inherit_id" ref="account.res_partner_view_search"/>
        <field name="arch" type="xml">
            <xpath expr="//filter[@name='customer']" position="replace">
                <filter string="Customers" name="customer" domain="['|',('customer','=',True),('customer','&gt;', 0)]"/> 
            </xpath>
            <xpath expr="//filter[@name='supplier']" position="replace">
                <filter string="Vendors" name="supplier" domain="['|',('supplier','=',True),('supplier_rank','&gt;', 0)]"/>
            </xpath>
            
            <xpath expr="//separator[3]" position="after">
                <filter string="Draft" name="filter_draft" domain="[('state','=','draft')]"/>
                <filter string="Waiting Approval" name="filter_waiting_approval" domain="[('state','=','waiting_approval')]"/>
                <filter string="Approved" name="filter_approved" domain="[('state','=','approved')]"/>
                <filter string="Reject" name="filter_reject" domain="[('state','=','reject')]"/>
                <separator/>
            </xpath>
        </field>
    </record>

    <record id="res_partner_kanban_inherited_state" model="ir.ui.view">
        <field name="name">res.partner.kanban.contactflow.inherit</field>
        <field name="model">res.partner</field>
        <field name="inherit_id" ref="base.res_partner_kanban_view"/>
        <field name="arch" type="xml">
            <xpath expr="//div[hasclass('oe_kanban_details')]" position="after">
                <div class="o_kanban_record_bottom" modifiers="{}">              
					<div class="oe_kanban_bottom_right">
						<field name="state" widget="label_selection" options="{'classes': {'draft': 'default', 'waiting_approval': 'warning', 'approved': 'success', 'reject': 'danger'}}"/>
					</div>
				</div>
            </xpath>
        </field>
    </record>
</odoo>